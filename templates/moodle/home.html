{% extends "moodle/base_moodle.html" %}

{% block page_title %}Dashboard · Moodle{% endblock %}
{% block page_subtitle %}
Visión general del sistema de formación y sincronización con Moodle.
{% endblock %}

{% block content %}

<!-- ================= KPIs ================= -->
<div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">

  <!-- Alumnos -->
  <div class="rounded-xl border border-gray-200 bg-[#FAF9F6] p-5">
    <p class="text-[11px] uppercase tracking-wide text-gray-500">
      Alumnos registrados
    </p>
    <p class="mt-2 text-3xl font-semibold text-gray-900">
      {{ student_count }}
    </p>
    <p class="mt-1 text-xs text-gray-500">
      En base de datos interna
    </p>
  </div>

  <!-- Cursos -->
  <div class="rounded-xl border border-gray-200 bg-[#FAF9F6] p-5">
    <p class="text-[11px] uppercase tracking-wide text-gray-500">
      Cursos Moodle
    </p>
    <p class="mt-2 text-3xl font-semibold text-gray-900">
      {{ course_count }}
    </p>
    <p class="mt-1 text-xs text-gray-500">
      Sincronizados vía API
    </p>
  </div>

  <!-- Estado sistema -->
  <div class="rounded-xl border border-gray-200 bg-[#FAF9F6] p-5">
    <p class="text-[11px] uppercase tracking-wide text-gray-500">
      Estado del sistema
    </p>
    <p class="mt-3 text-sm font-semibold text-emerald-700">
      Operativo
    </p>
    <p class="mt-1 text-xs text-gray-500">
      Celery + Redis activos
    </p>
  </div>

  <!-- Mensajería -->
  <div class="rounded-xl border border-gray-200 bg-gray-100 p-5 opacity-70">
    <p class="text-[11px] uppercase tracking-wide text-gray-400">
      Mensajería
    </p>
    <p class="mt-3 text-sm font-medium text-gray-400">
      WhatsApp (próximamente)
    </p>
    <p class="mt-1 text-xs text-gray-400">
      Solo lectura por ahora
    </p>
  </div>

</div>

<!-- ================= ACCIONES ================= -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">

  <!-- Acciones rápidas -->
  <div class="rounded-xl border border-gray-200 bg-white p-6">
    <h2 class="text-sm font-semibold text-gray-900 mb-4">
      Acciones rápidas
    </h2>

    <div class="flex flex-wrap gap-2">

      <a href="{% url 'student_create' %}"
         class="inline-flex items-center rounded-lg border border-blue-500 bg-blue-50 px-3 py-1.5
                text-xs font-medium text-blue-700 hover:bg-blue-100">
        Crear alumno
      </a>

      <a href="{% url 'student_list' %}"
         class="inline-flex items-center rounded-lg border border-gray-300 bg-gray-50 px-3 py-1.5
                text-xs font-medium text-gray-700 hover:bg-gray-100">
        Ver alumnos
      </a>

      <form method="post" action="{% url 'sync_courses' %}">
        {% csrf_token %}
        <button
          type="submit"
          class="inline-flex items-center rounded-lg border border-emerald-500 bg-emerald-50 px-3 py-1.5
                 text-xs font-medium text-emerald-700 hover:bg-emerald-100">
          Sincronizar cursos
        </button>
      </form>

    </div>
  </div>

  <!-- Roadmap -->
  <div class="rounded-xl border border-gray-200 bg-white p-6">
    <h2 class="text-sm font-semibold text-gray-900 mb-4">
      Próximas mejoras
    </h2>

    <ul class="space-y-2 text-xs text-gray-600">
      <li>• Actualización automática del progreso SCORM.</li>
      <li>• Detección de alumnos inactivos.</li>
      <li>• Mensajes automáticos por WhatsApp.</li>
      <li>• Alertas por email (fase empresa).</li>
    </ul>
  </div>

</div>

{% endblock %}
